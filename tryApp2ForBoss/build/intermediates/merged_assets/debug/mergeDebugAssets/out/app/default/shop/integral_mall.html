<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>积分兑换</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <script src="../static/js/config.js"></script>
    <script src="../static/js/jquery-3.0.0.js"></script>
    <script src="../static/js/androidJSInterface.js"></script>
    <!-- Link Swiper's CSS -->
    <link rel="stylesheet" href="../static/css/swiper.min4.0.css">
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">

    <!-- Demo styles -->
    <style>
        html, body {
            position: relative;
            height: 100%;
            overflow: hidden;
        }
        body {
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
            background: #eee;
            font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
            font-size: 14px;
            color:#000;
            margin: 0;
            padding: 0;
        }
        #bannerBox{
            width: 100%;
            height:22%;
        }
        .swiper-container {
            width: 100%;
            height: 100%;
        }
        .swiper-slide {
            text-align: center;
            font-size: 18px;
            background: #fff;
            /* Center slide text vertically */
            display: -webkit-box;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            -webkit-justify-content: center;
            justify-content: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            -webkit-align-items: center;
            align-items: center;
        }
        .goodsList{
            width: 100%; height: 7rem; margin-top: 2%;
        }
        #creditDetail{
            width: 100%;
            padding-top:2.5%;
            color:#B1001D;
            font-weight: bold;
            text-align: center;
            position: absolute;
            z-index: 1; top:0;left:0;
            background:#fff;
        }
        .hideContactService{
            /*display: none;*/
            position: relative;
            z-index: -1 !important;
            filter:alpha(opacity=0);  /*支持 IE 浏览器*/
            -moz-opacity:0; /*支持 FireFox 浏览器*/
            opacity: 0;
            transition: all 0.5s;
        }
        .showContactService{
            /*display: block;*/
            filter:alpha(opacity=100);  /*支持 IE 浏览器*/
            -moz-opacity:1; /*支持 FireFox 浏览器*/
            opacity: 1;
            transition: all 0.5s;
            width: 100%;
            height: 105%;
            background:rgba(0,0,0,0.7);
            position: absolute;
            z-index:2; left:0; top:0;
            color:rgb(177,0,29);
            font-weight: bold;
        }
    </style>
</head>


<body>
<!--<p style="margin: 50% auto; text-align:center; font-size: 1rem;">此功能正在开发中,敬请期待...</p>-->

<!-- Swiper -->
<div class="swiper-container swiper-container-horizontal" id="bannerBox">
    <!--  banner 存放区 -->
    <div class="swiper-wrapper" id="banner">
        <!--<div class="swiper-slide">-->
        <!--<img src="../static/images/categorytitle.png" alt="">-->
        <!--</div>-->
        <!--<div class="swiper-slide" >然而，图片不止一张</div>-->
        <!--<div class="swiper-slide" >这，已经是第三</div>-->
        <!--<div class="swiper-slide">哼，俺老四来也</div>-->
    </div>
    <!-- 分页器 -->
    <div class="swiper-pagination swiper-pagination-bullets swiper-pagination-bullets-dynamic" style="width: 80px;">
        <span class="swiper-pagination-bullet swiper-pagination-bullet-active" style="left: 32px;"></span>
        <span class="swiper-pagination-bullet swiper-pagination-bullet-active-next" style="left: 32px;"></span>
        <span class="swiper-pagination-bullet swiper-pagination-bullet-active-next-next" style="left: 32px;"></span>
        <span class="swiper-pagination-bullet" style="left: 32px;"></span>
        <span class="swiper-pagination-bullet" style="left: 32px;"></span>
    </div>
</div>
<div style="width: 100%; height: 5rem; line-height: 5rem; background: #fff; color:#B1001D; font-weight:bold; border-top:0.2rem solid #eee ; text-align: center;">
<span>
    <img src="../static/images/creditIcon.png" style="width:8%;"  alt="积分"><span>总积分 : </span><strong id="creditCount" > 加载中... </strong>
</span>
    <span style="display: inline-block; width: 20%;"></span>
    <span>
    <label style="display: inline;" for="btnForCreditDetail" id="btnForCreditDetail"><img src="../static/images/detailIcon.png" style="width:8%;" alt="详情" ><span>兑换详情</span></label>
</span>
</div>

<!-- 兑换列表 -->
<div style="background: #f5f5f5; margin-top:2rem;" class="goodsList_box" id="goodsList_box">
    <!--<div class="goodsList">-->
    <!--<div style="float: left; width: 49%; height: 8rem; background: #c7254e;">-->

    <!--</div>-->
    <!--<div style="float: right;width: 49%; height: 8rem; background: #c67605;">-->

    <!--</div>-->
    <!--</div>-->

    <!--<div class="goodsList">-->
    <!--<div style="float: left; width: 49%; height: 8rem; background: #c7254e;">-->

    <!--</div>-->
    <!--<div style="float: right;width: 49%; height: 8rem; background: #c67605;">-->

    <!--</div>-->
    <!--</div>-->
</div>

<div id="btnForContactService" style="text-align: center; height:15%; margin:5rem auto;">
    <button style="text-align: center;padding: 1rem 5rem; background: #B1001D; color:#fff; border: none; border-radius:0.5rem; box-shadow:0.3rem 0.6rem 0.6rem pink">
        积分兑换
    </button>
</div>

<!-- 兑换详情 -->
<div id="creditDetail" class="hideContactService">
    <div style="border: 1px solid #B1001D; width: 90%; position: absolute; left:5%;">
        <h4 style="display: block; font-weight: bold;">APP积分</h4>
        <p>积分获得规则 ：<br><br>
            成品订单：100元=1积分 &nbsp;&nbsp;&nbsp;&nbsp;  未满100元不计<br>
            裸石订单：300元=1积分 &nbsp;&nbsp;&nbsp;&nbsp;  未满300元不计<br><br>
            积分计入方式 ：<br><br>
            客户提交订单后<br>
            后台客服点击“确认订单”<br>
            后计入相应账户<br><br>
            兑换积分采用人工后台兑换方式<br>
            请联系客服进行兑换<br>
            客服微信号：ZSA-APP<br><br>
            <img src="../static/images/wechet.jpg" class="hrefToWechet" ontouchstart="holdDown()" ontouchend="holdUp()" style="width: 40% ; padding-bottom: 10%;"><br>
            <!--<a href="http://weixin.qq.com/r/-IKXjwTEx1m4rUDs99fu"><img src="../static/images/wechet.jpg" style="width: 40% ;"></a><br>-->
            <!--<a href="http://www.zsa888.com/app/index.php?c=goods&a=hreftowechet"><img src="../static/images/wechet.jpg" style="width: 40% ;"></a><br>-->
            长按二维码进入微信
        </p>
        <img src="../static/images/creditDetail_downRight.jpg" style="width: 15%; position: absolute; right:-1px; bottom:-1.2px;">
    </div>

</div>

<!-- 联系客服 -->
<div class="hideContactService" id="contactService">
    <div style=" width: 80%; text-align: center; position: absolute; z-index: 1; top:15%;left:10%; background:#f5f5f5; border-radius:10%; padding-top: 10% ;">
        <p>
            尊敬的客户：<br><br>

            兑换积分采用人工后台兑换方式<br>
            请联系客服进行兑换<br>
            客服微信号：ZSA-APP<br>
        </p>
        <div >
            <img src="../static/images/wechet.jpg" class="hrefToWechet" ontouchstart="holdDown()" ontouchend="holdUp()" style="width: 40% ; padding-bottom: 10%;"><br>
            <!--<a href="http://weixin.qq.com/r/-IKXjwTEx1m4rUDs99fu"><img src="../static/images/wechet.jpg" style="width: 40% ; padding-bottom: 10%;"></a>-->
            <!-- 中间页 -->
            <!--<a href="http://www.zsa888.com/app/index.php?c=goods&a=hreftowechet"><img src="../static/images/wechet.jpg" style="width: 40% ; padding-bottom: 10%;"></a>-->
        </div>
        <p>长按二维码进入微信</p>
    </div>
</div>

<!-- 兑换商品的大图 -->
<div id="bigGoodsListImg" class="hideContactService" style="width: 100%; height:100%; position: absolute; left:0; top:0; background: rgba(0,0,0,0.5);">

</div>

</body>


<!-- Swiper JS -->
<script src="../static/js/swiper.min4.0.js"></script>

<script>
    // 总积分数
    // http://www.zsa888.com /app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_points&key=
    var key = getKey();

    $.ajax({
//        url:appUrl + "/app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_points&key="+ "17d375be1a87810c5d6f0176c167e84c", // 测试
        url:appUrl + "/app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_points&key="+ key,// 正式
        type:"get",
        dataType:'jsonp',
        success:function (data) {
            var points = data.datas.points;
//            console.log(data.datas.points);
            var creditCount = document.getElementById("creditCount");
            creditCount.innerHTML = points;
//            $("#creditCount").text(points);
        }
    });
    function getKey() {
        var storage = window.localStorage;
        return  key = storage["use_key"] || getUrlParam('key');
    }
    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }

    // banner接口
    // http://www.zsa888.com /app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_roasting&callback=jQuery110105314299569411114_1513733818716&_=1513733818717%20HTTP/1.1

window.onload = function () {
// 蒙版只能使用原生
    var btnForCreditDetail,creditDetail,btnForContactService,contactService;
    btnForCreditDetail = document.getElementById("btnForCreditDetail");
    creditDetail = document.getElementById("creditDetail");
    btnForContactService = document.getElementById("btnForContactService");
    contactService = document.getElementById("contactService");

//积分详情
    clickEvent(btnForCreditDetail,creditDetail,"showContactService");
    clickEvent(creditDetail,creditDetail,"hideContactService");
// 联系客服
    clickEvent(btnForContactService,contactService,"showContactService");
    clickEvent(contactService,contactService,"hideContactService");

    function clickEvent(obj,obj1,className) {
        obj.onclick = function () {
            obj1.className = className;
        };
    }

    /*
     *  轮播图
     */
// banner图片的加载

    var ERROR = -1;
    var SUCCESS = 0;
// banner 占位图
    var bannerPlaceholder = [{
        advname: "首页",
        thumb: {
            url: "../static/images/categorytitle.png"
        }
    }];

    function BannerImage(data) {
//            console.log(data);
        if (!data || !data.thumb) {
            return false;
        }
        this.imgUrl = data.thumb.url;
//            console.log(this.imgUrl)

//        this.name = data.advname;
//        this.goodsid = data.goodsid;
//        this.tag = data.tag;
    }

    $.ajax({
//        url: appUrl + '/app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=goods&p=goods_ad',
        url:appUrl + "/app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_roasting&callback=jQuery110105314299569411114_1513733818716&_=1513733818717%20HTTP/1.1",
        type: 'get',
        dataType: 'jsonp',
        timeout: 5000,
        success: function (data) {
//                console.log(data.datas);
            var bannerList = [];
            if (data.resultCode == ERROR) {
                bannerList = bannerPlaceholder;
            } else {
                bannerList = data.datas;
//                    console.log(bannerList)
            }
            renderBanner(bannerList);
//            addEvent();
        },
        error: function (error) {
            renderBanner(bannerPlaceholder);
            console.log(error);
        }
    });

// 轮播生成
function renderBanner(data) {
if (!data) {
    return;
}
var html = '';
//            console.log(data[0]);
for (var i = 0, l = data.length; i < l; i++) {
    var img = new BannerImage(data[i]); // 根据长度创建新对象

    html += '<div class="swiper-slide banneritem">' +
        '<img class="bannerimg" src="' + data[i].thumb.url +
        '" style="display:inline-block;width:100%; height: 100%;" data-goodsid="' + data[i].goodsid +
        '" data-tag="' + data[i].tag +
        '" data-advname="' + data[i].advname + '">'+
        '</div>';
}
$('#banner').html(html);

var swiper = new Swiper('.swiper-container', {
    loop:true,
    autoplay:true,
    pagination: {
        el: '.swiper-pagination',
        dynamicBullets: true
    }
});
}

// 兑换商品列表
//http://www.zsa888.com /app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_gift&key=17d375be1a87810c5d6f0176c167e84c&callback=jQuery11010058174548355813815_1513753399376&_=1513753399377%20HTTP/1.1
$.ajax({
    url:appUrl + "/app/index.php?i=2&c=entry&m=ewei_shop&v=pad&do=member&p=member_gift&key=17d375be1a87810c5d6f0176c167e84c&callback=jQuery11010058174548355813815_1513753399376&_=1513753399377%20HTTP/1.1",
    type:'get',
    dataType:'jsonp',
    error: function (error) {
        console.log(error);
    },
    success:function (data) {
        var html = '';
        html +=
            ' <div class="goodsList">' +
            '<img style="float: left; width: 49%; height: 7rem;" src="'+ data.datas[0].image.url +' " alt="图片加载中...">'+
            '<img style="float: right; width: 49%; height: 7rem;" src="'+ data.datas[1].image.url +' " alt="图片加载中...">' +
            '</div>'+
            ' <div class="goodsList">' +
            '<img style="float: left; width: 49%; height: 7rem;" src="'+ data.datas[2].image.url +' " alt="图片加载中...">'+
            '<img style="float: right; width: 49%; height: 7rem;" src="'+ data.datas[3].image.url +' " alt="图片加载中...">' +
            '</div>';

        $('#goodsList_box').html(html);

        var bigGoodsList = $("#bigGoodsListImg");
        $(".goodsList img").click(function () {
//                    console.log(this);
//                    console.log(this.src);
            var html = '';
            html +=
                '<img style="width: 95%; position: absolute; left:2.5%; top:35%;" src='+ this.src +' alt="加载中...">';

            bigGoodsList.html(html);
            bigGoodsList.removeClass("hideContactService");
            bigGoodsList.addClass("showContactService");
        });

        bigGoodsList.click(function () {
            bigGoodsList.removeClass("showContactService");
            bigGoodsList.addClass("hideContactService");
        })
    }
});

};

// 长按二维码跳转进微信
//    var hrefToWechet = document.getElementsByClassName('hrefToWechet');
var timeStart,timeEnd,time;//申明全局变量

function getTimeNow()//获取此刻时间
{
    var now=new Date();
    return now.getTime();
}
function holdDown()//鼠标按下时触发
{
    timeStart=getTimeNow();//获取鼠标按下时的时间
    time=setInterval(function()//setInterval会每100毫秒执行一次
    {
        timeEnd=getTimeNow();//也就是每100毫秒获取一次时间
        if(timeEnd-timeStart>600)//如果此时检测到的时间与第一次获取的时间差有1000毫秒
        {
            clearInterval(time);//便不再继续重复此函数 （clearInterval取消周期性执行）
//            alert("长按");//并弹出代码
            openHrefToWechat();
        }
    },100);
}
function holdUp()
{
    clearInterval(time);//如果按下时间不到1000毫秒便弹起，
    return false;
}

</script>

</html>